<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Connexion</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../CSS/tableAdmin.css"/>
        <link rel="stylesheet" type="text/css" href="../../CSS/Programme.css"/>
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js"></script>
    </head>

    <body>

        <div id="addLiens" class="container-fluid justify-content-evenly" style="text-align:center;align-content:center;justify-content:center;padding:5%;">
            <div class='row justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>
                <div class='row justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>
                <h4>Type de liens</h4>
               <input id='inputType' type='text' placeholder='Type de lien' autocomplete='no''>

       </div>
       <div class='row justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>
           <h4>Nom de la personne qui met le liens</h4>
           <input id='inputNom' type='text' placeholder='Personne qui ajoute le lien' autocomplete='no' >
           <h4>Lien</h4>
           <input id='inputLiens' type='text' placeholder='Le lien' autocomplete='no'>
       </div>
       <div class='row justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>     
               <h4>Description du lien</h4>
               <textarea id='inputDescription' type='text' rows='4' cols='50' half placeholder='Description'></textarea>
       </div>

       <div class='row justify-content-evenly'  style='text-align:center;align-content:center;justify-content:center;'>
           <div class='col justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>
               <p id='btnTester' class='horizontal'><span class='text'>Tester le liens</span></p>
           </div>
           <div class='col justify-content-evenly' style='text-align:center;align-content:center;justify-content:center;'>
               <p id='btnConfirmer' class='horizontal'><span class='text'>Ajouter le lien</span></p>
           </div>
       </div>
        </div>


    </body>


    <script>
        function resize() {
            if(screen.width>800){
                jQuery('#MenuBar').load('Menu.html#MenuOrdi');
            }
            else{
                jQuery('#MenuBar').load('MenuCell.html#MenuCell');
            }
        }
        $(window).on("resize", resize);
        resize();




            $("#btnTester").click(function() {	
                var test = $("#inputLiens").val();	
                window.location.replace(test);
            });

             $("#btnConfirmer").click(function() {
            var mdp = $("#inputMdp").val();
            if (confirm("Êtes-vous certain des informations entrées?")) 
            {
                var type= $("#inputType").val();
                var description= $("#inputDescription").val();
                var lien= $("#inputLiens").val();
                var personne= $("#inputNom").val();

                if(type=="" || type==null || type.length>15){
                    alert("Le champ type de liens ne peut pas être vide et ne peut pas contenir plus de 15 caractères");
                }else{
                    if(type=="Programmation" || type=="Informatique"  || type=="Annonce" ){
                        if(description=="" || description==null || description.length>500){
                            alert("Le champ description ne peut pas être vide et ne peut pas contenir plus de 500 caractères");
                        }
                        else{
                            if(lien=="" || lien==null || lien.length>200){
                                alert("Le champ lien ne peut pas être vide et ne peut pas contenir plus de 200 caractères");
                            }
                            else{
                                if(personne=="" || personne==null || personne.length>30 || !(/^[A-Za-z\s]+$/.test(personne))){
                                    alert("Le champ personne ne peut pas être vide et ne peut pas contenir plus de 30 caractères. Aussi il doit être composé de lettre seulement.");
                                }
                                else{
                                        $.ajax({
                                            url: "../PHP/Gestion_Liens/addLink.php",
                                            type: "POST",
                                            data: {
                                                "type":  type,
                                                "description": description,
                                                "lien":  lien,
                                                "personne":  personne
                                            },
                                            dataType: "json",
                                            success: function(result){
                                                alert("Le lien à bien été ajouté");
                                                location.reload();
                                            },
                                            error: function (message, er) {
                                                console.log("error: " + er);
                                            }
                                        });
                                    }
                                }
                            }

                    }else{
                        alert("Le champ type de liens doit correspondre à l'une des catégories suivantes: Programmation, Informatique ou Annonce");
                    }
                }
            }
        });

    </script>
</html>